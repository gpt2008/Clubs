{"ast":null,"code":"import React from\"react\";import{withTranslation}from\"react-i18next\";import{Rest}from\"utils/utils\";import View from\"./ServiceForm\";import{jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";class ServiceFormContainer extends React.Component{constructor(){super(...arguments);this.state={previewVisible:false,previewImage:\"\",previewTitle:\"\"};this.loadData=()=>{Rest().operation({type:\"SelectPortfolioServiceById\",idPortfolioService:this.props.idPortfolioService}).then(response=>{this.setState({service:response},()=>this.loadSpecialities());});};this.loadSpecialities=()=>{Rest().operation({type:\"SelectAllSpecialities\"}).then(response=>{this.setState({specialities:response,loaded:true});});};this.handleCancel=e=>this.setState({previewVisible:false});this.handlePreview=async file=>{if(!file.url&&!file.preview){file.preview=await this.getBase64(file.originFileObj);}this.setState({previewImage:file.url||file.preview,previewVisible:true,previewTitle:file.name||file.url&&file.url.substring(file.url.lastIndexOf(\"/\")+1)});};this.getBase64=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.readAsDataURL(file);reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);});};this.validateAndSave=form=>{form.validateFields().then(values=>{this.save(values);});};this.save=async values=>{const serviceImageBase64Data=values.files&&values.files[0]&&!values.files[0].url&&values.files[0].originFileObj?await this.getBase64(values.files[0].originFileObj):undefined;Rest().operation({type:this.props.idPortfolioService?\"EditPortfolioService\":\"NewPortfolioService\",idPortfolio:this.props.idPortfolio,idPortfolioService:this.props.idPortfolioService,speciality:values.speciality.value,nameService:values.nameService,valueDuration:values.valueDuration,amtPrice:values.amtPrice,flagAllowOnlineRes:values.flagAllowOnlineRes?1:0,flagAllowOnlineVid:values.flagAllowOnlineVid?1:0,flagShowPrice:values.flagShowPrice?1:0,flagAllowPriorPayment:values.flagAllowPriorPayment?1:0,base64ImageService:serviceImageBase64Data?serviceImageBase64Data:undefined,hasServicePhoto:values.files&&values.files.length>0?true:false}).then(response=>this.props.onClose(true));};}componentDidMount(){if(this.props.idPortfolioService){this.loadData();}else{this.loadSpecialities();}}render(){return this.state.loaded?/*#__PURE__*/_jsx(View,{...this.state,visible:this.props.visible,namePortfolio:this.props.namePortfolio,edit:!!this.props.idPortfolioService,onCancel:()=>this.props.onClose(false),onSubmit:this.validateAndSave,handlePreview:this.handlePreview,handleCancel:this.handleCancel}):/*#__PURE__*/_jsx(_Fragment,{});}}export default withTranslation(\"serviceForm\")(ServiceFormContainer);","map":{"version":3,"names":["React","withTranslation","Rest","View","jsx","_jsx","Fragment","_Fragment","ServiceFormContainer","Component","constructor","arguments","state","previewVisible","previewImage","previewTitle","loadData","operation","type","idPortfolioService","props","then","response","setState","service","loadSpecialities","specialities","loaded","handleCancel","e","handlePreview","file","url","preview","getBase64","originFileObj","name","substring","lastIndexOf","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","validateAndSave","form","validateFields","values","save","serviceImageBase64Data","files","undefined","idPortfolio","speciality","value","nameService","valueDuration","amtPrice","flagAllowOnlineRes","flagAllowOnlineVid","flagShowPrice","flagAllowPriorPayment","base64ImageService","hasServicePhoto","length","onClose","componentDidMount","render","visible","namePortfolio","edit","onCancel","onSubmit"],"sources":["/home/gpt2008/Desktop/Clubs/club/club/club-ui/src/components/services/ServiceFormContainer.tsx"],"sourcesContent":["import { FormInstance } from \"antd\";\nimport { Store } from \"antd/lib/form/interface\";\nimport { RcFile } from \"antd/lib/upload\";\nimport React from \"react\";\nimport { WithTranslation, withTranslation } from \"react-i18next\";\nimport PortfolioService from \"types/entities/Portfolio\";\nimport Speciality from \"types/entities/Speciality\";\nimport SavePortfolioService from \"types/operations/SavePortfolioService\";\nimport { Rest } from \"utils/utils\";\nimport View from \"./ServiceForm\";\n\ninterface IProps {\n\tidPortfolio: number;\n\tnamePortfolio: string;\n\tidPortfolioService?: number;\n\tvisible?: boolean;\n\tonClose: (save: boolean) => void;\n}\n\nexport interface IState {\n\tservice?: PortfolioService;\n\tnewService?: PortfolioService;\n\tspecialities?: Speciality[];\n\tloaded?: boolean;\n\tpreviewVisible: boolean;\n\tpreviewImage: string;\n\tpreviewTitle: string;\n}\n\nclass ServiceFormContainer extends React.Component<WithTranslation & IProps, IState> {\n\tpublic state: IState = {\n\t\tpreviewVisible: false,\n\t\tpreviewImage: \"\",\n\t\tpreviewTitle: \"\",\n\t};\n\n\tpublic componentDidMount() {\n\t\tif (this.props.idPortfolioService) {\n\t\t\tthis.loadData();\n\t\t} else {\n\t\t\tthis.loadSpecialities();\n\t\t}\n\t}\n\n\tpublic render() {\n\t\treturn this.state.loaded ? (\n\t\t\t<View\n\t\t\t\t{...this.state}\n\t\t\t\tvisible={this.props.visible}\n\t\t\t\tnamePortfolio={this.props.namePortfolio}\n\t\t\t\tedit={!!this.props.idPortfolioService}\n\t\t\t\tonCancel={() => this.props.onClose(false)}\n\t\t\t\tonSubmit={this.validateAndSave}\n\t\t\t\thandlePreview={this.handlePreview}\n\t\t\t\thandleCancel={this.handleCancel}\n\t\t\t/>\n\t\t) : (\n\t\t\t<></>\n\t\t);\n\t}\n\n\tprivate loadData = () => {\n\t\tRest<{ type: string; idPortfolioService: number }, PortfolioService>()\n\t\t\t.operation({\n\t\t\t\ttype: \"SelectPortfolioServiceById\",\n\t\t\t\tidPortfolioService: this.props.idPortfolioService!,\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({ service: response }, () => this.loadSpecialities());\n\t\t\t});\n\t};\n\n\tprivate loadSpecialities = () => {\n\t\tRest<{ type: string }, Speciality[]>()\n\t\t\t.operation({ type: \"SelectAllSpecialities\" })\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({ specialities: response, loaded: true });\n\t\t\t});\n\t};\n\n\tprivate handleCancel = (e: React.MouseEvent<HTMLElement>) =>\n\t\tthis.setState({ previewVisible: false });\n\n\tprivate handlePreview = async (file: any) => {\n\t\tif (!file.url && !file.preview) {\n\t\t\tfile.preview = await this.getBase64(file.originFileObj);\n\t\t}\n\n\t\tthis.setState({\n\t\t\tpreviewImage: file.url || file.preview,\n\t\t\tpreviewVisible: true,\n\t\t\tpreviewTitle: file.name || (file.url && file.url.substring(file.url.lastIndexOf(\"/\") + 1)),\n\t\t});\n\t};\n\n\tprivate getBase64 = (file: RcFile) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.readAsDataURL(file);\n\t\t\treader.onload = () => resolve(reader.result);\n\t\t\treader.onerror = (error) => reject(error);\n\t\t});\n\t};\n\n\tprivate validateAndSave = (form: FormInstance) => {\n\t\tform.validateFields().then((values) => {\n\t\t\tthis.save(values);\n\t\t});\n\t};\n\n\tprivate save = async (values: Store) => {\n\t\tconst serviceImageBase64Data =\n\t\t\tvalues.files && values.files[0] && !values.files[0].url && values.files[0].originFileObj\n\t\t\t\t? await this.getBase64(values.files[0].originFileObj)\n\t\t\t\t: undefined;\n\t\tRest<SavePortfolioService, any>()\n\t\t\t.operation({\n\t\t\t\ttype: this.props.idPortfolioService ? \"EditPortfolioService\" : \"NewPortfolioService\",\n\t\t\t\tidPortfolio: this.props.idPortfolio,\n\t\t\t\tidPortfolioService: this.props.idPortfolioService,\n\t\t\t\tspeciality: values.speciality.value,\n\t\t\t\tnameService: values.nameService,\n\t\t\t\tvalueDuration: values.valueDuration,\n\t\t\t\tamtPrice: values.amtPrice,\n\t\t\t\tflagAllowOnlineRes: values.flagAllowOnlineRes ? 1 : 0,\n\t\t\t\tflagAllowOnlineVid: values.flagAllowOnlineVid ? 1 : 0,\n\t\t\t\tflagShowPrice: values.flagShowPrice ? 1 : 0,\n\t\t\t\tflagAllowPriorPayment: values.flagAllowPriorPayment ? 1 : 0,\n\t\t\t\tbase64ImageService: serviceImageBase64Data ? serviceImageBase64Data : undefined,\n\t\t\t\thasServicePhoto: values.files && values.files.length > 0 ? true : false,\n\t\t\t})\n\t\t\t.then((response) => this.props.onClose(true));\n\t};\n}\n\nexport default withTranslation(\"serviceForm\")(ServiceFormContainer);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}