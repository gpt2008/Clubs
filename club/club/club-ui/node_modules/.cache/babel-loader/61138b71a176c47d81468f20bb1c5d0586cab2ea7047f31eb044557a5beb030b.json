{"ast":null,"code":"import{addDays,getISODay,isBefore}from\"date-fns\";import React from\"react\";import{withTranslation}from\"react-i18next\";import{Rest}from\"utils/utils\";import CalendarWidget from\"./CalendarWidget\";import{jsx as _jsx}from\"react/jsx-runtime\";class CalendarWidgetContainer extends React.Component{constructor(){super(...arguments);this.state={dayCalendar:new Date()};this.loadSlots=day=>{Rest().operation({type:\"SelectAvailabilities\",days:7,dateStart:day,dateUser:new Date(),idProvider:this.props.idProvider,idLocation:this.props.idLocation,idEquivalentAppointment:this.props.idEquivalentAppointment},true).then(response=>{let startDay=getISODay(day);let tmSlots=response.map(e=>{let slot=e;let slotDay=slot.valueDayOfTheWeek-startDay+1;if(slotDay<=0){slotDay=slotDay+7;}slot.valueDayOfTheWeek=slotDay;return slot;});this.setState({slots:tmSlots,loadingSlots:false,loading:false});}).catch(()=>{this.setState({loadingSlots:false,loading:false});});};this.isCurrentWeek=()=>{return isBefore(this.state.dayCalendar,new Date());};this.nextWeek=()=>{const newDay=addDays(this.state.dayCalendar,7);this.setState({dayCalendar:newDay},()=>{this.loadSlots(this.state.dayCalendar);});};this.prevWeek=()=>{if(this.isCurrentWeek()){return;}const newDay=addDays(this.state.dayCalendar,-7);this.setState({dayCalendar:newDay},()=>{this.loadSlots(this.state.dayCalendar);});};this.selectSlot=slot=>{var _this$state$slotSelec,_this$state$slotSelec2;if(slot.dateAvailability===((_this$state$slotSelec=this.state.slotSelected)===null||_this$state$slotSelec===void 0?void 0:_this$state$slotSelec.dateAvailability)&&slot.valueTimeMinutes===((_this$state$slotSelec2=this.state.slotSelected)===null||_this$state$slotSelec2===void 0?void 0:_this$state$slotSelec2.valueTimeMinutes)){this.setState({slotSelected:undefined},()=>this.props.selectSlot(undefined));}else{this.setState({slotSelected:slot},()=>this.props.selectSlot(slot));}};}componentDidMount(){this.setState({slotSelected:this.props.currentSlot},()=>this.loadSlots(this.state.dayCalendar));}render(){return/*#__PURE__*/_jsx(CalendarWidget,{...this.state,nextWeek:this.nextWeek,prevWeek:this.prevWeek,isCurrentWeek:this.isCurrentWeek,selectSlot:this.selectSlot});}}export default withTranslation(\"agendasStep\")(CalendarWidgetContainer);","map":{"version":3,"names":["addDays","getISODay","isBefore","React","withTranslation","Rest","CalendarWidget","jsx","_jsx","CalendarWidgetContainer","Component","constructor","arguments","state","dayCalendar","Date","loadSlots","day","operation","type","days","dateStart","dateUser","idProvider","props","idLocation","idEquivalentAppointment","then","response","startDay","tmSlots","map","e","slot","slotDay","valueDayOfTheWeek","setState","slots","loadingSlots","loading","catch","isCurrentWeek","nextWeek","newDay","prevWeek","selectSlot","_this$state$slotSelec","_this$state$slotSelec2","dateAvailability","slotSelected","valueTimeMinutes","undefined","componentDidMount","currentSlot","render"],"sources":["/home/gpt2008/Desktop/Clubs/club/club/club-ui/src/components/calendar/slots/CalendarWidgetContainer.tsx"],"sourcesContent":["import { addDays, getISODay, isBefore } from \"date-fns\";\nimport React from \"react\";\nimport { WithTranslation, withTranslation } from \"react-i18next\";\nimport { SlotStepInfo } from \"types/entities/StepsInfo\";\nimport { SelectAvailabilitiesOperation } from \"types/operations/Slot\";\nimport { Rest } from \"utils/utils\";\nimport CalendarWidget from \"./CalendarWidget\";\n\nexport interface IProps {\n\tidLocation?: number;\n\tidProvider?: number;\n\tidEquivalentAppointment?: number;\n\tcurrentSlot?: SlotStepInfo;\n\tselectSlot: (slot?: SlotStepInfo) => void;\n}\n\nexport interface IState {\n\tloading?: boolean;\n\tloadingSlots?: boolean;\n\tdayCalendar: Date;\n\tslots?: SlotStepInfo[];\n\tslotSelected?: SlotStepInfo;\n}\n\nclass CalendarWidgetContainer extends React.Component<WithTranslation & IProps, IState> {\n\tpublic state: IState = {\n\t\tdayCalendar: new Date(),\n\t};\n\n\tpublic componentDidMount() {\n\t\tthis.setState({ slotSelected: this.props.currentSlot }, () =>\n\t\t\tthis.loadSlots(this.state.dayCalendar)\n\t\t);\n\t}\n\n\tpublic render() {\n\t\treturn (\n\t\t\t<CalendarWidget\n\t\t\t\t{...this.state}\n\t\t\t\tnextWeek={this.nextWeek}\n\t\t\t\tprevWeek={this.prevWeek}\n\t\t\t\tisCurrentWeek={this.isCurrentWeek}\n\t\t\t\tselectSlot={this.selectSlot}\n\t\t\t/>\n\t\t);\n\t}\n\n\tprivate loadSlots = (day: Date) => {\n\t\tRest<SelectAvailabilitiesOperation, SlotStepInfo[]>()\n\t\t\t.operation(\n\t\t\t\t{\n\t\t\t\t\ttype: \"SelectAvailabilities\",\n\t\t\t\t\tdays: 7,\n\t\t\t\t\tdateStart: day,\n\t\t\t\t\tdateUser: new Date(),\n\t\t\t\t\tidProvider: this.props.idProvider,\n\t\t\t\t\tidLocation: this.props.idLocation,\n\t\t\t\t\tidEquivalentAppointment: this.props.idEquivalentAppointment,\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t)\n\t\t\t.then((response) => {\n\t\t\t\tlet startDay = getISODay(day);\n\t\t\t\tlet tmSlots = response.map((e) => {\n\t\t\t\t\tlet slot = e;\n\t\t\t\t\tlet slotDay = slot.valueDayOfTheWeek - startDay + 1;\n\t\t\t\t\tif (slotDay <= 0) {\n\t\t\t\t\t\tslotDay = slotDay + 7;\n\t\t\t\t\t}\n\t\t\t\t\tslot.valueDayOfTheWeek = slotDay;\n\t\t\t\t\treturn slot;\n\t\t\t\t});\n\t\t\t\tthis.setState({ slots: tmSlots, loadingSlots: false, loading: false });\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.setState({ loadingSlots: false, loading: false });\n\t\t\t});\n\t};\n\n\tprivate isCurrentWeek = () => {\n\t\treturn isBefore(this.state.dayCalendar, new Date());\n\t};\n\n\tprivate nextWeek = () => {\n\t\tconst newDay = addDays(this.state.dayCalendar, 7);\n\t\tthis.setState({ dayCalendar: newDay }, () => {\n\t\t\tthis.loadSlots(this.state.dayCalendar);\n\t\t});\n\t};\n\n\tprivate prevWeek = () => {\n\t\tif (this.isCurrentWeek()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newDay = addDays(this.state.dayCalendar, -7);\n\t\tthis.setState({ dayCalendar: newDay }, () => {\n\t\t\tthis.loadSlots(this.state.dayCalendar);\n\t\t});\n\t};\n\n\tprivate selectSlot = (slot: SlotStepInfo) => {\n\t\tif (\n\t\t\tslot.dateAvailability === this.state.slotSelected?.dateAvailability &&\n\t\t\tslot.valueTimeMinutes === this.state.slotSelected?.valueTimeMinutes\n\t\t) {\n\t\t\tthis.setState({ slotSelected: undefined }, () => this.props.selectSlot(undefined));\n\t\t} else {\n\t\t\tthis.setState({ slotSelected: slot }, () => this.props.selectSlot(slot));\n\t\t}\n\t};\n}\n\nexport default withTranslation(\"agendasStep\")(CalendarWidgetContainer);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}