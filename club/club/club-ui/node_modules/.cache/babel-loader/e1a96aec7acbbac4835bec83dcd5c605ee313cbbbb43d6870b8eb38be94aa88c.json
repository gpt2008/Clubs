{"ast":null,"code":"import dayjs from\"dayjs\";import React from\"react\";import{withTranslation}from\"react-i18next\";import enumAppointmentCancellationProposal from\"types/enums/EnumAppointmentCancellationProposal\";import{EnumAppointmentTypeStatus}from\"../../types/enums/AppointmentTypeStatus\";import{Rest}from\"../../utils/utils\";import CancellationDetails from\"./CancellationDetails\";import{jsx as _jsx}from\"react/jsx-runtime\";class CancellationDetailsContainer extends React.Component{constructor(){super(...arguments);this.state={step:0};this.goBack=()=>{this.setState({step:this.state.step-1});};this.nextStep=form=>{form.validateFields().then(values=>{if(this.state.step>0){this.save(values);return;}const firstPageFields={cancellationReasonType:values.cancellationReasonType,cancellationReasonValue:values.cancellationReasonValue,additionalMessage:values.additionalMessage};this.setState({step:this.state.step+1,firstPageFields});});};this.getAlternativeAppointment=form=>{const values=form.getFieldsValue();if(values.alternativeProposal===enumAppointmentCancellationProposal.NO_PROPOSITION){this.setState({tableKey:new Date().getTime()});return;}const appointments=(this.props.appointments||[]).map(app=>{return{idAppointment:app.idAppointment,prestador:app.idPrestador,location:app.idLocation,appointmentValueDay:app.dateAppointment.getDay()===0?7:app.dateAppointment.getDay(),appointmentValueTime:app.valueTime};});const proposedDateFrom=values.proposedDateFrom?new Date(values.proposedDateFrom):this.props.dateFilter?this.props.dateFilter.toDate():dayjs().add(1,\"days\").toDate();Rest().operation({type:\"GetAlternativeAppointmentDates\",alternativeProposal:values.alternativeProposal,proposedDateFrom:new Date(proposedDateFrom.setHours(0,0,0,0)),appointments}).then(response=>{this.setState({alternatives:response,tableKey:new Date().getTime()});});};this.save=values=>{var _this$state$firstPage,_this$state$firstPage2,_this$state$firstPage3;Rest().operation({type:\"MultipleCancellation\",typeStatus:EnumAppointmentTypeStatus.CANCELLED,typeStatusDetail:(_this$state$firstPage=this.state.firstPageFields)===null||_this$state$firstPage===void 0?void 0:_this$state$firstPage.cancellationReasonType,valueStatusReason:(_this$state$firstPage2=this.state.firstPageFields)===null||_this$state$firstPage2===void 0?void 0:_this$state$firstPage2.cancellationReasonValue,additionalMessage:(_this$state$firstPage3=this.state.firstPageFields)===null||_this$state$firstPage3===void 0?void 0:_this$state$firstPage3.additionalMessage,alternativeProposal:values.alternativeProposal,proposedDate:values.proposedDate,appointments:(this.props.appointments||[]).map(app=>app.idAppointment),alternatives:this.state.alternatives||[]}).then(()=>this.props.onClose(true));};}render(){return/*#__PURE__*/_jsx(CancellationDetails,{...this.state,visible:this.props.visible,appointments:this.props.appointments,dateFilter:this.props.dateFilter,cancelledByManager:this.props.cancelledByManager,onCancel:()=>this.props.onClose(false),goBack:this.goBack,nextStep:this.nextStep,dateRender:this.props.dateRender,statusRender:this.props.statusRender,getAlternativeAppointment:this.getAlternativeAppointment});}}export default withTranslation(\"appointmentCancellation\")(CancellationDetailsContainer);","map":{"version":3,"names":["dayjs","React","withTranslation","enumAppointmentCancellationProposal","EnumAppointmentTypeStatus","Rest","CancellationDetails","jsx","_jsx","CancellationDetailsContainer","Component","constructor","arguments","state","step","goBack","setState","nextStep","form","validateFields","then","values","save","firstPageFields","cancellationReasonType","cancellationReasonValue","additionalMessage","getAlternativeAppointment","getFieldsValue","alternativeProposal","NO_PROPOSITION","tableKey","Date","getTime","appointments","props","map","app","idAppointment","prestador","idPrestador","location","idLocation","appointmentValueDay","dateAppointment","getDay","appointmentValueTime","valueTime","proposedDateFrom","dateFilter","toDate","add","operation","type","setHours","response","alternatives","_this$state$firstPage","_this$state$firstPage2","_this$state$firstPage3","typeStatus","CANCELLED","typeStatusDetail","valueStatusReason","proposedDate","onClose","render","visible","cancelledByManager","onCancel","dateRender","statusRender"],"sources":["/home/gpt2008/Desktop/Clubs/club/club/dentycard-policlinico-bo-ui/src/components/appointmentCancellation/CancellationDetailsContainer.tsx"],"sourcesContent":["import { FormInstance } from \"antd\";\nimport { Store } from \"antd/lib/form/interface\";\nimport dayjs from \"dayjs\";\nimport React from \"react\";\nimport { WithTranslation, withTranslation } from \"react-i18next\";\nimport {\n\tdefault as AppointmentAlternative,\n\tdefault as AppointmentData,\n} from \"types/entities/Appointment\";\nimport enumAppointmentCancellationProposal from \"types/enums/EnumAppointmentCancellationProposal\";\nimport { EnumAppointmentTypeStatus } from \"../../types/enums/AppointmentTypeStatus\";\nimport {\n\tMultipleCancellationOperation,\n\tMultipleCancellationResponse,\n} from \"../../types/operations\";\nimport { Rest } from \"../../utils/utils\";\nimport CancellationDetails from \"./CancellationDetails\";\n\ninterface IProps {\n\tvisible?: boolean;\n\tappointments?: AppointmentData[];\n\tlimit?: number;\n\tdateFilter?: any;\n\tdateRender: (record: AppointmentData) => void;\n\tstatusRender: (typeStatus: number) => void;\n\tonClose: (save: boolean) => void;\n\tcancelledByManager?: boolean;\n}\n\nexport interface IState {\n\tstep: number;\n\ttableKey?: number;\n\talternatives?: AppointmentAlternative[];\n\tfirstPageFields?: {\n\t\tcancellationReasonType: number;\n\t\tcancellationReasonValue?: string;\n\t\tadditionalMessage?: string;\n\t};\n}\n\nclass CancellationDetailsContainer extends React.Component<WithTranslation & IProps, IState> {\n\tpublic state: IState = {\n\t\tstep: 0,\n\t};\n\n\tpublic render() {\n\t\treturn (\n\t\t\t<CancellationDetails\n\t\t\t\t{...this.state}\n\t\t\t\tvisible={this.props.visible}\n\t\t\t\tappointments={this.props.appointments}\n\t\t\t\tdateFilter={this.props.dateFilter}\n\t\t\t\tcancelledByManager={this.props.cancelledByManager}\n\t\t\t\tonCancel={() => this.props.onClose(false)}\n\t\t\t\tgoBack={this.goBack}\n\t\t\t\tnextStep={this.nextStep}\n\t\t\t\tdateRender={this.props.dateRender}\n\t\t\t\tstatusRender={this.props.statusRender}\n\t\t\t\tgetAlternativeAppointment={this.getAlternativeAppointment}\n\t\t\t/>\n\t\t);\n\t}\n\n\tprivate goBack = () => {\n\t\tthis.setState({ step: this.state.step - 1 });\n\t};\n\n\tprivate nextStep = (form: FormInstance) => {\n\t\tform.validateFields().then((values) => {\n\t\t\tif (this.state.step > 0) {\n\t\t\t\tthis.save(values);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst firstPageFields = {\n\t\t\t\tcancellationReasonType: values.cancellationReasonType,\n\t\t\t\tcancellationReasonValue: values.cancellationReasonValue,\n\t\t\t\tadditionalMessage: values.additionalMessage,\n\t\t\t};\n\t\t\tthis.setState({ step: this.state.step + 1, firstPageFields });\n\t\t});\n\t};\n\n\tprivate getAlternativeAppointment = (form: FormInstance) => {\n\t\tconst values = form.getFieldsValue();\n\n\t\tif (values.alternativeProposal === enumAppointmentCancellationProposal.NO_PROPOSITION) {\n\t\t\tthis.setState({ tableKey: new Date().getTime() });\n\t\t\treturn;\n\t\t}\n\n\t\tconst appointments = (this.props.appointments || []).map((app) => {\n\t\t\treturn {\n\t\t\t\tidAppointment: app.idAppointment,\n\t\t\t\tprestador: app.idPrestador,\n\t\t\t\tlocation: app.idLocation,\n\t\t\t\tappointmentValueDay: app.dateAppointment.getDay() === 0 ? 7 : app.dateAppointment.getDay(),\n\t\t\t\tappointmentValueTime: app.valueTime,\n\t\t\t};\n\t\t});\n\n\t\tconst proposedDateFrom = values.proposedDateFrom\n\t\t\t? new Date(values.proposedDateFrom)\n\t\t\t: this.props.dateFilter\n\t\t\t? this.props.dateFilter.toDate()\n\t\t\t: dayjs().add(1, \"days\").toDate();\n\n\t\tRest<\n\t\t\t{\n\t\t\t\ttype: string;\n\t\t\t\talternativeProposal: number;\n\t\t\t\tproposedDateFrom: Date;\n\t\t\t\tappointments: any;\n\t\t\t},\n\t\t\tAppointmentAlternative[]\n\t\t>()\n\t\t\t.operation({\n\t\t\t\ttype: \"GetAlternativeAppointmentDates\",\n\t\t\t\talternativeProposal: values.alternativeProposal,\n\t\t\t\tproposedDateFrom: new Date(proposedDateFrom.setHours(0, 0, 0, 0)),\n\t\t\t\tappointments,\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({\n\t\t\t\t\talternatives: response,\n\t\t\t\t\ttableKey: new Date().getTime(),\n\t\t\t\t});\n\t\t\t});\n\t};\n\n\tprivate save = (values: Store) => {\n\t\tRest<MultipleCancellationOperation, MultipleCancellationResponse>()\n\t\t\t.operation({\n\t\t\t\ttype: \"MultipleCancellation\",\n\t\t\t\ttypeStatus: EnumAppointmentTypeStatus.CANCELLED,\n\t\t\t\ttypeStatusDetail: this.state.firstPageFields?.cancellationReasonType!,\n\t\t\t\tvalueStatusReason: this.state.firstPageFields?.cancellationReasonValue,\n\t\t\t\tadditionalMessage: this.state.firstPageFields?.additionalMessage,\n\t\t\t\talternativeProposal: values.alternativeProposal,\n\t\t\t\tproposedDate: values.proposedDate,\n\t\t\t\tappointments: (this.props.appointments || []).map((app) => app.idAppointment),\n\t\t\t\talternatives: this.state.alternatives || [],\n\t\t\t})\n\t\t\t.then(() => this.props.onClose(true));\n\t};\n}\n\nexport default withTranslation(\"appointmentCancellation\")(CancellationDetailsContainer);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}