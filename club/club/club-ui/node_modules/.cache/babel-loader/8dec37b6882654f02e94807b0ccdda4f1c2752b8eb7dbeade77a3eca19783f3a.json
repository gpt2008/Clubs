{"ast":null,"code":"import{notification}from\"antd\";import ClosingPeriodFormContainer from\"components/closingPeriods/ClosingPeriodFormContainer\";import LocationDetailsFormContainer from\"components/details/LocationDetailsFormContainer\";import _ from\"lodash\";import React from\"react\";import{withTranslation}from\"react-i18next\";import{Rest}from\"utils/utils\";import View from\"./LocationList\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";class LocationListContainer extends React.Component{constructor(){super(...arguments);this.state={page:0,locations:[],filtersLoading:false};this.openLocationForm=idLocation=>{this.setState({locationFormVisible:true,locationFormKey:new Date().getTime(),idLocationSelected:idLocation});};this.closeLocationForm=save=>{this.setState({locationFormVisible:false,idLocationSelected:undefined},()=>{if(save){notification[\"success\"]({message:this.props.t(\"titles:actionPerformed\")});this.applyFilters();}});};this.onClickConfigurationClosingPeriods=(idLocation,nameLocation)=>{this.setState({formConfigClosingPeriodVisible:true,formConfigClosingPeriodKey:new Date().getTime(),idLocationSelected:idLocation,nameLocationSelected:nameLocation});};this.onCloseConfigurationClosingPeriodForm=saved=>{this.setState({formConfigClosingPeriodVisible:false,idLocationSelected:undefined,nameLocationSelected:undefined},()=>{if(saved){this.applyFilters();}});};this.searchFilter=_.debounce(values=>this.doSearchFilter(values.filter),500);this.doSearchFilter=value=>{Rest().operation({type:\"GetLocationsData\",filter:value?value:null}).then(response=>{this.setState({locations:response,highlightfilter:value});});};this.filterData=(offset,name,idOrganization)=>{if(offset){this.setState({page:offset});}else{this.setState({page:0});}Rest().operation({type:\"SelectLocationsPaged\",name:name?name:undefined,idOrganization:idOrganization?idOrganization:undefined,limit:10,offset:offset?(offset-1)*10:0}).then(response=>{this.setState({...this.state,locations:response.data,loaded:true,forceReloadTimestamp:new Date().getTime(),countData:Number(response.dataCount)});}).catch(()=>{//message.error(\"Error al cargar las citas.\");\n}).finally(()=>{this.setState({...this.state,filtersLoading:false,highlightfilter:name});});};this.applyFilters=(offset,name,idOrganization)=>{this.setState({filtersLoading:true});this.filterData(offset,name,idOrganization);};}componentDidMount(){this.applyFilters();}render(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(View,{locations:this.state.locations,loadLocationsData:this.applyFilters,dataCount:this.state.countData,page:this.state.page,openLocationForm:this.openLocationForm,onClickConfigurationClosingPeriods:this.onClickConfigurationClosingPeriods,searchFilter:this.searchFilter,highlightfilter:this.state.highlightfilter//applyFilters={this.applyFilters}\n,filtersLoading:this.state.filtersLoading}),/*#__PURE__*/_jsx(LocationDetailsFormContainer,{visible:this.state.locationFormVisible,idLocationSelected:this.state.idLocationSelected,onClose:this.closeLocationForm},this.state.locationFormKey),/*#__PURE__*/_jsx(ClosingPeriodFormContainer,{idLocation:this.state.idLocationSelected,nameLocation:this.state.nameLocationSelected,// Force form regeneration\nvisible:this.state.formConfigClosingPeriodVisible,onClose:this.onCloseConfigurationClosingPeriodForm},this.state.formConfigClosingPeriodKey)]});}}export default withTranslation(\"locationList\")(LocationListContainer);","map":{"version":3,"names":["notification","ClosingPeriodFormContainer","LocationDetailsFormContainer","_","React","withTranslation","Rest","View","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","LocationListContainer","Component","constructor","arguments","state","page","locations","filtersLoading","openLocationForm","idLocation","setState","locationFormVisible","locationFormKey","Date","getTime","idLocationSelected","closeLocationForm","save","undefined","message","props","t","applyFilters","onClickConfigurationClosingPeriods","nameLocation","formConfigClosingPeriodVisible","formConfigClosingPeriodKey","nameLocationSelected","onCloseConfigurationClosingPeriodForm","saved","searchFilter","debounce","values","doSearchFilter","filter","value","operation","type","then","response","highlightfilter","filterData","offset","name","idOrganization","limit","data","loaded","forceReloadTimestamp","countData","Number","dataCount","catch","finally","componentDidMount","render","children","loadLocationsData","visible","onClose"],"sources":["/home/gpt2008/Desktop/Clubs/club/club/dentycard-policlinico-bo-ui/src/pages/locations/LocationListContainer.tsx"],"sourcesContent":["import { notification } from \"antd\";\nimport ClosingPeriodFormContainer from \"components/closingPeriods/ClosingPeriodFormContainer\";\nimport LocationDetailsFormContainer from \"components/details/LocationDetailsFormContainer\";\nimport _ from \"lodash\";\nimport React from \"react\";\nimport { WithTranslation, withTranslation } from \"react-i18next\";\nimport LocationDetails from \"types/entities/Location\";\nimport Organization from \"types/entities/Organization\";\nimport { Rest } from \"utils/utils\";\nimport View from \"./LocationList\";\n\nexport interface IState {\n\tlocations: LocationDetails[];\n\tloaded?: boolean;\n\tlocationFormVisible?: boolean;\n\tlocationFormKey?: number;\n\tformConfigClosingPeriodVisible?: boolean;\n\tformConfigClosingPeriodKey?: number;\n\tidLocationSelected?: number;\n\tnameLocationSelected?: string;\n\tforceReloadTimestamp?: number;\n\thighlightfilter?: string;\n\tpage: number;\n\tcountData?: number;\n\tfiltersLoading: boolean;\n\torganizations?: Organization[];\n}\n\nclass LocationListContainer extends React.Component<WithTranslation, IState> {\n\tpublic state: IState = {\n\t\tpage: 0,\n\t\tlocations: [],\n\t\tfiltersLoading: false,\n\t};\n\n\tpublic componentDidMount() {\n\t\tthis.applyFilters();\n\t}\n\n\tpublic render() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<View\n\t\t\t\t\tlocations={this.state.locations}\n\t\t\t\t\tloadLocationsData={this.applyFilters}\n\t\t\t\t\tdataCount={this.state.countData}\n\t\t\t\t\tpage={this.state.page}\n\t\t\t\t\topenLocationForm={this.openLocationForm}\n\t\t\t\t\tonClickConfigurationClosingPeriods={this.onClickConfigurationClosingPeriods}\n\t\t\t\t\tsearchFilter={this.searchFilter}\n\t\t\t\t\thighlightfilter={this.state.highlightfilter}\n\t\t\t\t\t//applyFilters={this.applyFilters}\n\t\t\t\t\tfiltersLoading={this.state.filtersLoading}\n\t\t\t\t/>\n\n\t\t\t\t<LocationDetailsFormContainer\n\t\t\t\t\tkey={this.state.locationFormKey}\n\t\t\t\t\tvisible={this.state.locationFormVisible}\n\t\t\t\t\tidLocationSelected={this.state.idLocationSelected}\n\t\t\t\t\tonClose={this.closeLocationForm}\n\t\t\t\t/>\n\n\t\t\t\t<ClosingPeriodFormContainer\n\t\t\t\t\tidLocation={this.state.idLocationSelected}\n\t\t\t\t\tnameLocation={this.state.nameLocationSelected}\n\t\t\t\t\tkey={this.state.formConfigClosingPeriodKey} // Force form regeneration\n\t\t\t\t\tvisible={this.state.formConfigClosingPeriodVisible}\n\t\t\t\t\tonClose={this.onCloseConfigurationClosingPeriodForm}\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t}\n\n\tprivate openLocationForm = (idLocation?: number) => {\n\t\tthis.setState({\n\t\t\tlocationFormVisible: true,\n\t\t\tlocationFormKey: new Date().getTime(),\n\t\t\tidLocationSelected: idLocation,\n\t\t});\n\t};\n\n\tprivate closeLocationForm = (save: boolean) => {\n\t\tthis.setState({ locationFormVisible: false, idLocationSelected: undefined }, () => {\n\t\t\tif (save) {\n\t\t\t\tnotification[\"success\"]({\n\t\t\t\t\tmessage: this.props.t(\"titles:actionPerformed\"),\n\t\t\t\t});\n\t\t\t\tthis.applyFilters();\n\t\t\t}\n\t\t});\n\t};\n\n\tprivate onClickConfigurationClosingPeriods = (idLocation: number, nameLocation: string) => {\n\t\tthis.setState({\n\t\t\tformConfigClosingPeriodVisible: true,\n\t\t\tformConfigClosingPeriodKey: new Date().getTime(),\n\t\t\tidLocationSelected: idLocation,\n\t\t\tnameLocationSelected: nameLocation,\n\t\t});\n\t};\n\n\tprivate onCloseConfigurationClosingPeriodForm = (saved: boolean) => {\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tformConfigClosingPeriodVisible: false,\n\t\t\t\tidLocationSelected: undefined,\n\t\t\t\tnameLocationSelected: undefined,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tif (saved) {\n\t\t\t\t\tthis.applyFilters();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n\n\tprivate searchFilter = _.debounce((values: any) => this.doSearchFilter(values.filter), 500);\n\n\tprivate doSearchFilter = (value: any) => {\n\t\tRest<{ type: string; filter: string }, LocationDetails[]>()\n\t\t\t.operation({\n\t\t\t\ttype: \"GetLocationsData\",\n\t\t\t\tfilter: value ? value : null,\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({\n\t\t\t\t\tlocations: response,\n\t\t\t\t\thighlightfilter: value,\n\t\t\t\t});\n\t\t\t});\n\t};\n\n\tprivate filterData = (offset?: number, name?: string, idOrganization?: number) => {\n\t\tif (offset) {\n\t\t\tthis.setState({ page: offset });\n\t\t} else {\n\t\t\tthis.setState({ page: 0 });\n\t\t}\n\n\t\tRest<\n\t\t\t{ type: string; limit: number; offset: number; name?: string; idOrganization?: number },\n\t\t\t{ limit: string; offset: string; dataCount: string; data: LocationDetails[] }\n\t\t>()\n\t\t\t.operation({\n\t\t\t\ttype: \"SelectLocationsPaged\",\n\t\t\t\tname: name ? name : undefined,\n\t\t\t\tidOrganization: idOrganization ? idOrganization : undefined,\n\t\t\t\tlimit: 10,\n\t\t\t\toffset: offset ? (offset - 1) * 10 : 0,\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({\n\t\t\t\t\t...this.state,\n\t\t\t\t\tlocations: response.data,\n\t\t\t\t\tloaded: true,\n\t\t\t\t\tforceReloadTimestamp: new Date().getTime(),\n\t\t\t\t\tcountData: Number(response.dataCount),\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\t//message.error(\"Error al cargar las citas.\");\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.setState({ ...this.state, filtersLoading: false, highlightfilter: name });\n\t\t\t});\n\t};\n\n\tprivate applyFilters = (offset?: number, name?: string, idOrganization?: number) => {\n\t\tthis.setState({\n\t\t\tfiltersLoading: true,\n\t\t});\n\t\tthis.filterData(offset, name, idOrganization);\n\t};\n}\n\nexport default withTranslation(\"locationList\")(LocationListContainer);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}